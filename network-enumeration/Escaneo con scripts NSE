Enumeración Avanzada con Nmap (NSE + Version Detection)

Objetivo
Realizar enumeración de servicios utilizando scripts por defecto de Nmap (NSE) para obtener información adicional sobre los servicios detectados.

Objetivo analizado:
scanme.nmap.org


Herramienta utilizada
Nmap 7.98  
Sistema: Kali Linux  


Comando ejecutado

nmap -sC -sV scanme.nmap.org

Parámetros utilizados:

- -sC → Ejecuta scripts NSE por defecto
- -sV → Detecta versiones de los servicios


Muestra del Resultado
![Escaneo Nmap NSE](images/Nmap%20NSE.PNG)
![Escaneo Nmap NSE](images/nmap-nse-scan.png)

Resultados Relevantes

Puerto 22 - SSH
Servicio:
OpenSSH 6.6.1p1 Ubuntu

Información adicional obtenida:
- Claves públicas del servidor (DSA, RSA, ECDSA, ED25519)

Análisis:
El script ssh-hostkey permitió enumerar las claves públicas del servidor, lo que confirma la configuración del servicio SSH y puede utilizarse para fingerprinting o detección de cambios en infraestructura.



Puerto 80 - HTTP
Servicio:
Apache httpd 2.4.7 (Ubuntu)

Información adicional:
- Título del sitio: "Go ahead and ScanMe!"
- Server header: Apache/2.4.7 (Ubuntu)
- Favicon identificado como perteneciente al proyecto Nmap

Análisis:
Los scripts http-title y http-server-header permiten identificar:
- Tecnología del servidor web
- Versión del servidor
- Posible fingerprinting del sitio

La versión Apache 2.4.7 no es actual, lo que podría motivar investigación en bases de datos CVE.

Puerto 9929 - Nping echo
Servicio activo de prueba perteneciente al proyecto Nmap.



Puertos filtrados
- 25 (SMTP)
- 514 (Shell)

Análisis:
El estado "filtered" sugiere la presencia de firewall o reglas de filtrado de paquetes.


Análisis Técnico General

El uso de -sC permitió obtener información adicional sin necesidad de especificar scripts manualmente.

La combinación -sC -sV mejora significativamente la fase de enumeración al:

- Identificar versiones exactas
- Obtener metadata del servicio
- Detectar configuraciones expuestas

Esto demuestra la importancia de la enumeración profunda en pruebas de penetración.


Conclusión

La ejecución de scripts NSE amplía la visibilidad sobre los servicios activos.

La enumeración detallada:

- Reduce incertidumbre
- Permite investigación de vulnerabilidades específicas
- Mejora la comprensión de la superficie de ataque

Este laboratorio refuerza la importancia de la fase de reconocimiento en ciberseguridad.

